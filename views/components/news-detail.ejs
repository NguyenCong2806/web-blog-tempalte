
<style>
    /* 1. Xử lý Căn Giữa (align-center) */
    /* Dùng display: table để margin auto hoạt động chuẩn với figure */
    .prose figure.align-center {
        margin-left: auto;
        margin-right: auto;
        display: table; 
        clear: both;
    }

    /* 2. Xử lý Căn Trái (align-left) */
    .prose figure.align-left {
        float: left;
        margin-right: 1.5rem; /* Tạo khoảng cách với chữ bên phải */
        margin-bottom: 1rem;
        margin-top: 0.5rem;
        clear: left;
    }

    /* 3. Xử lý Căn Phải (align-right) */
    .prose figure.align-right {
        float: right;
        margin-left: 1.5rem; /* Tạo khoảng cách với chữ bên trái */
        margin-bottom: 1rem;
        margin-top: 0.5rem;
        clear: right;
    }

    /* 4. Fix lỗi ảnh bị méo hoặc quá to khi float */
    .prose figure.align-left img, 
    .prose figure.align-right img {
        max-width: 50vw; /* Giới hạn chiều rộng ảnh khi float để không chiếm hết màn hình */
    }

    /* 5. Căn chỉnh Caption (chú thích ảnh) */
    .prose figure figcaption {
        text-align: center;
        color: #1a3c6e;
        font-size: 0.875rem;
        font-style: italic;
        margin-top: 0.5rem;
    }
</style>
<div class="container mx-auto px-4 py-8 font-sans">
  <article class="max-w-4xl mx-auto bg-white p-4 md:p-8 rounded-xl shadow-sm border border-gray-100">
    
    <header class="mb-8 border-b border-gray-100 pb-6">
      <h1 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900 leading-tight">
        <%= newsItem.title %>
      </h1>

      <div class="flex flex-wrap items-center text-gray-500 text-sm gap-4 mb-6">
        <span class="flex items-center font-medium text-blue-600">
          <i class="fa-solid fa-user mr-2"></i> 
          <%= newsItem.author || 'Ban biên tập' %>
        </span>
        
        <span class="hidden sm:inline text-gray-300">|</span>

        <span class="flex items-center">
            <i class="fa-regular fa-clock mr-2"></i>
            <%= newsItem.createddate ? new Date(newsItem.createddate).toLocaleDateString('vi-VN') : 'Đang cập nhật' %>
        </span>
        
        <% if (newsItem.views) { %>
           <span class="hidden sm:inline text-gray-300">|</span>
           <span class="flex items-center">
             <i class="fa-solid fa-eye mr-2"></i> <%= newsItem.views %> lượt xem
           </span>
        <% } %>
      </div>

      <% if (newsItem.img) { %>
        <figure class="relative rounded-lg overflow-hidden shadow-md">
            <img 
              src="<%= newsItem.img %>" 
              alt="<%= newsItem.imgAlt || newsItem.title %>" 
              class="w-full h-auto max-h-[500px] object-cover transition-transform duration-700 hover:scale-105"
              onerror="this.style.display='none'"
            >
            <% if (newsItem.imgAlt) { %>
                <figcaption class="text-center text-gray-500 text-sm mt-2 italic p-2 bg-gray-50">
                    <%= newsItem.imgAlt %>
                </figcaption>
            <% } %>
        </figure>
      <% } %>
    </header>

    <%- include('../components/table-of-contents.ejs', { contentId: 'post-content' }) %>

    <div id="post-content" class="prose prose-lg max-w-none prose-headings:text-gray-800 prose-headings:font-bold prose-img:rounded-lg prose-a:text-blue-600 hover:prose-a:text-blue-800 prose-p:text-gray-700 prose-li:text-gray-700">
      <% if (newsItem.detail) { %>
          <%- newsItem.detail %>
      <% } else { %>
          <p class="text-gray-500 italic p-4 bg-gray-50 rounded text-center">Nội dung đang được cập nhật...</p>
      <% } %>
    </div>
    
    <% if (newsItem.tags && newsItem.tags.length > 0) { %>
        <div class="mt-12 pt-6 border-t border-gray-100">
            <div class="flex items-center gap-2 mb-3">
                <i class="fa-solid fa-tags text-blue-600"></i>
                <span class="font-semibold text-gray-700">Chủ đề liên quan:</span>
            </div>
            <div class="flex flex-wrap gap-2">
                <% newsItem.tags.forEach(tag => { %>
                    <a href="/search?keyword=<%= tag %>" class="px-4 py-1.5 bg-gray-100 hover:bg-blue-100 text-gray-600 hover:text-blue-700 rounded-full text-sm font-medium transition-all duration-200">
                        #<%= tag %>
                    </a>
                <% }) %>
            </div>
        </div>
    <% } %>

  </article>
</div>